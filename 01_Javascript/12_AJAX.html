
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<script type="application/javascript">

//El objeto XMLHttpRequest
//----------------------------------------------
//Identidad
//-responseText. guarda el contenido del body de la respuesta. por defecto ""
//
//Funcionalidad
//-open(metodo, url, asincrono)
//-send(xXx)

function enviarPeticionSincrona(){

    //Para enviar una petición ajax primero necesitamos un objeto XMLHttpRequest
    let xhr = new XMLHttpRequest()

    //Open sirve para inicializar el objeto XMLHttpRequest. Recibe tres parámetros
    //-Método HTTP
    //-Url
    //-Sincrono/asincrono false/true. Por defecto es true
    xhr.open("GET","https://reqres.in/api/users?delay=10",false)

    //Cuando la petición es síncrona el hilo de ejecución se queda detenido en la llamada 
    //a 'send' hasta que se recibe la respuesta
    console.log("Antes  :"+xhr.responseText)
    //Esto no...no se refresca los que ve el usuario hasta que se termine de ejecutar
    //todo el código JS
    document.getElementById("mensaje").innerHTML = "Espere por favor"
    
    xhr.send(null)

    console.log("Despues:"+xhr.responseText)
    document.getElementById("mensaje").innerHTML = ""

    //En responseText tenemos el contenido del body de la respuesta
    let json = xhr.responseText
    let respuesta = JSON.parse(json)
    /*
    {
            page: 1, 
            per_page: 6, 
            total: 12, 
            total_pages: 2, 
            data: [ usr1, usr2, usr3, usr4, usr5, usr6 ]
    }
    */
    console.log(respuesta)
    console.log(respuesta.data)
    rellenarTabla(respuesta.data)

}

function rellenarTabla(usuarios){

    


}


window.onload = function(){
    btnListarUsuariosSincrono.onclick = enviarPeticionSincrona
    //btnListarUsuariosAsincrono.onclick = enviarPeticionAsincrona
    //btnListarUsuariosMillenial.onclick = enviarPeticionMillenial
    //btnListarUsuariosFuncionGenerica.onclick = enviarPeticionGenerica
}

</script>


<body>

    <h1>12_AJAX</h1>

    <hr/>

    <p align="center">
        <button id="btnListarUsuariosSincrono">Listar Síncrono</button>
        <button id="btnListarUsuariosAsincrono">Listar Asíncrono</button>
        <button id="btnListarUsuariosMillenial">Listar Millenial</button>
        <button id="btnListarUsuariosFuncionGenerica">Listar Funcion Genérica</button>
    </p>

    <input type="text"/>

    <div id="mensaje"></div>

    <h1 align="center" id="mensaje"></h1>

    <table align="center" border="1">
        <tr>
            <th>Nombre</th>
            <th>Apellidos</th>
            <th>Correo E</th>
            <th>Afoto</th>
        </tr>
        <tbody id="tablaUsuarios"></tbody>
    </table>
    
</body>
</html>



